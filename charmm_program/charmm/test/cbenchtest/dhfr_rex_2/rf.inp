* CHARMM c38a2 testcase fastepdstr.inp.
*

stream datadir.def

if ?repdstr .ne. 1 then
 if ?repdstr2 .ne. 1 then
  echo "REPD not compiled in"
  echo "This test NOT performed"
  stop
endif
endif

if ?numnode .eq. 1 then
  echo "REPD only works in parallel"
  stop
endif

open unit 1 read card name @0toph19.rtf
read rtf card unit 1
close unit 1

open unit 1 read card name @0param19.prm
read param card unit 1
close unit 1

read sequence card
3
AMN ALA CBX
generate ala2 setup warn

ic para
ic seed 1 C 2 N 2 CA
ic build

open unit 30 write card name @9fastrepdstr.exch

repd nrep 4 -
 fast exch unit 30 freq 10  -
  temp0 300. -
  temp1 325. -
  temp2 350. -
  temp3 375.

open write file unit 50 name @9dyn.trj

open write card unit 41 name @9dyn.res
open write card unit 42 name rfout
outu 42

!prnl 6 node 0

random oldrandom iseed 31415
dyna verlet strt nstep 100 timestep 0.001  -
    iprfrq 10000 ihtfrq 0 ieqfrq 1000 ntrfrq 10000  -
    iuncrd 50 iunrea -1 iunwri 41 kunit -1 -
    nprint 1 nsavc 1 nsavv 0 ihbfrq 0  -
    firstt 300.0 finalt 300.0 teminc 0.0  tstruc 307.0 -
    iasors 0 iasvel 1 iscvel 0 ichecw 0 twindh 10.0 twindl -10.0


!repd reset


stop
